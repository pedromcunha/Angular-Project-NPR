/*Trailer Parke 17-11-2014 */
var app=angular.module("trailerParke",["templates-main","appFiltersModule","appControllerModule","appDirectiveModule","appFactoriesModule","ui.router","ui.bootstrap"]),searchInput;app.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("/",{url:"/",templateUrl:"../public/templates/trailer-listings.html",controller:"videoListingController"}).state("/register",{url:"/register",templateUrl:"../public/templates/register.html"})}]),app.constant("apiKeys",{youtubeAPI:"AIzaSyDYhqH1guvlxxocuttrwxE2kkvYefu0cqo",rottenTomatoesAPI:"4cwjthjq2hyxz7amh6jj5p4p"}),function(){var a=angular.module("appControllerModule",[]);a.controller("headerController",["$scope","$sce","apiKeys","rottenTomatoesService","youtubeApiService","sharedVideos",function(a,b,c,d,e,f){a.autocompleteSearch=function(b){var e="http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey="+c.rottenTomatoesAPI+"&q="+b.split(" ").join("+")+"&page_limit=5&callback=JSON_CALLBACK",f=[],g="";b.length>5?d.getRatings(e).success(function(b){a.ShowAutoSuggestions=!0;var c,d;if(b.movies.length>0){for(var e=0;e<b.movies.length;e++)c=b.movies[e].ratings.critics_score,d=b.movies[e].title,""!=d&&d.length<33?g=d:d.length>36&&(g=d.slice(0,36)+"..."),-1!=c&&d.length>0&&f.push({title:g,rating:c});a.AutoSuggestions=f}}).error(function(){console.log("err")}):(a.AutoSuggestions="",a.Ratings="")},a.submitSearch=function(c){var d,g=a.searchText;if(void 0==c)var c=a.searchText,d="https://gdata.youtube.com/feeds/api/videos?q="+g.split(" ").join("+")+"+official+trailer&v=2&max-results=3&alt=json&category=movies&callback=JSON_CALLBACK";else d="https://gdata.youtube.com/feeds/api/videos?q="+c.split(" ").join("+")+"+official+trailer+-game&v=2&orderby=relevance&max-results=20&hd=true&alt=json&category=movies&callback=JSON_CALLBACK";e.getVideos(d).success(function(c){if(void 0!=c.feed.entry){for(var d=[],e=0,g=c.feed.entry.length;g>e;e++)d.push(b.trustAsResourceUrl(c.feed.entry[e].link[0].href.replace("watch?v=","embed/").replace("&feature=youtube_gdata","")));f.videos=d,console.log(d),a.searchText=""}else f.videos=""}).error(function(){console.log("err")})},a.genres=[{name:"horror",id:10},{name:"sci-fi",id:13},{name:"drama",id:6},{name:"comedy",id:4},{name:"thriller"},{name:"documentary"},{name:"animation",id:2},{name:"action",id:1},{name:"romance",id:12},{name:"crime",id:5},{name:"family",id:8},{name:"sports",id:15},{name:"adventure",id:1},{name:"fantasy"},{name:"history"},{name:"mystery",id:11},{name:"musical"},{name:"western"}],a.select=function(b){a.selected=b},a.genreClass=function(b){return b===a.selected?"active":void 0}}]),a.controller("videoListingController",["$scope","sharedVideos",function(a,b){a.programs=b}])}(),function(){var a=angular.module("appDirectiveModule",[]);a.directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}})}(),function(){var a=angular.module("appFactoriesModule",[]);a.factory("youtubeApiService",["$http",function(a){var b={};return b.getVideos=function(b){return a({method:"JSONP",url:b,cache:!0})},b}]),a.factory("rottenTomatoesService",["$http",function(a){var b={};return b.getRatings=function(b){return a({method:"JSONP",url:b,cache:!0})},b}]),a.factory("sharedVideos",function(){var a={};return a})}(),function(){var a=angular.module("appFiltersModule",[]);a.filter("capitalize",function(){return function(a){if(a instanceof Array){for(var b=0,c=a.length,d=[];c>b;b++)d.push(a[b][0].toUpperCase()+a[b].slice(1));return d}return a[0].toUpperCase()+a.slice(1)}})}();