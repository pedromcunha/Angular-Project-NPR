var app=angular.module("trailerParke",["appFiltersModule","appControllerModule","appDirectiveModule","appFactoriesModule","ngRoute","ui.bootstrap"]),searchInput;app.config(["$routeProvider",function(e){e.when("/",{templateUrl:"../templates/trailer-listings.html",controller:"searchAutocompController"}).when("/login",{templateUrl:"../templates/login.html"})}]),app.constant("apiKeys",{youtubeAPI:"AIzaSyDYhqH1guvlxxocuttrwxE2kkvYefu0cqo",rottenTomatoesAPI:"4cwjthjq2hyxz7amh6jj5p4p"}),function(){var e=angular.module("appControllerModule",[]);e.controller("searchController",["$scope","$sce","youtubeApiService",function(e,t,o){e.submitSearch=function(r){var n,a=e.searchText;if(void 0==r)var r=e.searchText,n="https://gdata.youtube.com/feeds/api/videos?q="+a.split(" ").join("+")+"+official+trailer&v=2&max-results=3&alt=json&category=movies&callback=JSON_CALLBACK";else n="https://gdata.youtube.com/feeds/api/videos?q="+r.split(" ").join("+")+"+official+trailer+-game&v=2&orderby=relevance&max-results=20&hd=true&alt=json&category=movies&callback=JSON_CALLBACK";o.getVideos(n).success(function(o){if(void 0!=o.feed.entry){for(var r=[],n=0,a=o.feed.entry.length;a>n;n++)r.push(t.trustAsResourceUrl(o.feed.entry[n].link[0].href.replace("watch?v=","embed/").replace("&feature=youtube_gdata","")));e.programs=r,e.searchText=""}else e.programs=""}).error(function(){console.log("err")})}}]),e.controller("genreController",["$scope",function(e){e.genres=[{name:"horror",id:10},{name:"sci-fi",id:13},{name:"drama",id:6},{name:"comedy",id:4},{name:"thriller"},{name:"documentary"},{name:"animation",id:2},{name:"action",id:1},{name:"romance",id:12},{name:"crime",id:5},{name:"family",id:8},{name:"sports",id:15},{name:"adventure",id:1},{name:"fantasy"},{name:"history"},{name:"mystery",id:11},{name:"musical"},{name:"western"}],e.select=function(t){e.selected=t},e.genreClass=function(t){return t===e.selected?"active":void 0}}]),e.controller("searchAutocompController",["$scope","$sce","apiKeys","rottenTomatoesService",function(e,t,o,r){e.autocompleteSearch=function(t){var n="http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey="+o.rottenTomatoesAPI+"&q="+t.split(" ").join("+")+"&page_limit=5&callback=JSON_CALLBACK",a=[],i="";t.length>5?r.getRatings(n).success(function(t){e.ShowAutoSuggestions=!0;var o,r;if(t.movies.length>0){for(var n=0;n<t.movies.length;n++)o=t.movies[n].ratings.critics_score,r=t.movies[n].title,""!=r&&r.length<33?i=r:r.length>36&&(i=r.slice(0,36)+"..."),-1!=o&&r.length>0&&a.push({title:i,rating:o});e.AutoSuggestions=a}}).error(function(){console.log("err")}):e.AutoSuggestions="",e.Ratings=""}}])}(),function(){var e=angular.module("appDirectiveModule",[]);e.directive("ngEnter",function(){return function(e,t,o){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(o.ngEnter)}),t.preventDefault())})}})}(),function(){var e=angular.module("appFactoriesModule",[]);e.factory("youtubeApiService",["$http",function(e){var t={};return t.getVideos=function(t){return e({method:"JSONP",url:t,cache:!0})},t}]),e.factory("rottenTomatoesService",["$http",function(e){var t={};return t.getRatings=function(t){return e({method:"JSONP",url:t,cache:!0})},t}])}(),function(){var e=angular.module("appFiltersModule",[]);e.filter("capitalize",function(){return function(e){if(e instanceof Array){for(var t=0,o=e.length,r=[];o>t;t++)r.push(e[t][0].toUpperCase()+e[t].slice(1));return r}return e[0].toUpperCase()+e.slice(1)}})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQSxLQUFBLFFBQUEsT0FBQSxnQkFBQSxtQkFDWSxzQkFDQSxxQkFDQSxxQkFDQSxVQUNBLGlCQUNaLFdBR0EsS0FBQSxRQUFBLGlCQUFBLFNBQUEsR0FDUSxFQUNDLEtBQUEsS0FFRSxZQUFBLHFDQUNHLFdBQUEsNkJBRUYsS0FBQSxVQUVFLFlBQUEsK0JBSWQsSUFBQSxTQUFBLFdBQ0MsV0FBQSwwQ0FDQSxrQkFBQSw2QkFFRCxXQUNBLEdBQUEsR0FBQSxRQUFBLE9BQUEseUJBQ0MsR0FBQSxXQUFBLG9CQUFnQyxTQUFBLE9BQUEsb0JBQUEsU0FBQSxFQUFBLEVBQUEsR0FDL0IsRUFBQSxhQUFBLFNBQUEsR0FDRyxHQUNHLEdBREgsRUFBQSxFQUFBLFVBRUEsSUFBQSxRQUFBLEVBQ0MsR0FBQSxHQUFBLEVBQUEsV0FDQyxFQUFBLGdEQUFBLEVBQUEsTUFBQSxLQUFBLEtBQUEsS0FBQSwwRkFFRixHQUFBLGdEQUFBLEVBQUEsTUFBQSxLQUFBLEtBQUEsS0FBQSxzSEFDRCxHQUFBLFVBQUEsR0FBQSxRQUFBLFNBQUEsR0FDRCxHQUFBLFFBQUEsRUFBQSxLQUFBLE1BQUEsQ0FFQyxJQUFBLEdBREEsTUFDQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEtBQUEsTUFBQSxPQUFBLEVBQUEsRUFBQSxJQUNDLEVBQUEsS0FBQSxFQUFBLG1CQUFBLEVBQUEsS0FBQSxNQUFBLEdBQUEsS0FBQSxHQUFBLEtBQUEsUUFBQSxXQUFBLFVBQUEsUUFBQSx5QkFBQSxLQUVELEdBQUEsU0FBQSxFQUNBLEVBQUEsV0FBQSxPQUdBLEdBQUEsU0FBQSxLQUVELE1BQUEsV0FDQyxRQUFBLElBQUEsYUFJSCxFQUFBLFdBQUEsbUJBQStCLFNBQUEsU0FBQSxHQUM5QixFQUFBLFNBQ0MsS0FBQSxTQUFBLEdBQUEsS0FDQSxLQUFBLFNBQUEsR0FBQSxLQUNBLEtBQUEsUUFBQSxHQUFBLElBQ0EsS0FBQSxTQUFBLEdBQUEsSUFDQSxLQUFBLGFBQ0EsS0FBQSxnQkFDQSxLQUFBLFlBQUEsR0FBQSxJQUNBLEtBQUEsU0FBQSxHQUFBLElBQ0EsS0FBQSxVQUFBLEdBQUEsS0FDQSxLQUFBLFFBQUEsR0FBQSxJQUNBLEtBQUEsU0FBQSxHQUFBLElBQ0EsS0FBQSxTQUFBLEdBQUEsS0FDQSxLQUFBLFlBQUEsR0FBQSxJQUNBLEtBQUEsWUFDQSxLQUFBLFlBQ0EsS0FBQSxVQUFBLEdBQUEsS0FDQSxLQUFBLFlBQ0EsS0FBQSxZQUVELEVBQUEsT0FBQSxTQUFBLEdBQ08sRUFBQSxTQUFBLEdBRUosRUFBQSxXQUFBLFNBQUEsR0FDSSxNQUFBLEtBQUEsRUFBQSxTQUFBLFNBQUEsV0FJUixFQUFBLFdBQUEsNEJBQXdDLFNBQUEsT0FBQSxVQUFBLHdCQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDdkMsRUFBQSxtQkFBQSxTQUFBLEdBQ0UsR0FBQSxHQUFBLG9FQUFBLEVBQUEsa0JBQUEsTUFBQSxFQUFBLE1BQUEsS0FBQSxLQUFBLEtBQUEsdUNBQ0UsS0FFRCxFQUFBLEVBQ0YsR0FBQSxPQUFBLEVBQ0MsRUFBQSxXQUFBLEdBQUEsUUFBQSxTQUFBLEdBQ0UsRUFBQSxxQkFBQSxDQUNBLElBQUEsR0FBQSxDQUNBLElBQUEsRUFBQSxPQUFBLE9BQUEsRUFBQSxDQUNDLElBQUEsR0FBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsT0FBQSxJQUNFLEVBQUEsRUFBQSxPQUFBLEdBQUEsUUFBQSxjQUNBLEVBQUEsRUFBQSxPQUFBLEdBQUEsTUFDQSxJQUFBLEdBQUEsRUFBQSxPQUFBLEdBQ0MsRUFBQSxFQUNELEVBQUEsT0FBQSxLQUNDLEVBQUEsRUFBQSxNQUFBLEVBQUEsSUFBQSxPQUNELElBQUEsR0FBQSxFQUFBLE9BQUEsR0FDQyxFQUFBLE1BQUEsTUFBQSxFQUFBLE9BQUEsR0FHSCxHQUFBLGdCQUFBLEtBRUYsTUFBQSxXQUNDLFFBQUEsSUFBQSxTQUlGLEVBQUEsZ0JBQUEsR0FDQSxFQUFBLFFBQUEsVUFJSixXQUNJLEdBQUEsR0FBQSxRQUFBLE9BQUEsd0JBQ0ksR0FBQSxVQUFBLFVBQXNCLFdBQ2xCLE1BQUEsVUFBQSxFQUFBLEVBQUEsR0FDSSxFQUFBLEtBQUEsbUJBQUEsU0FBQSxHQUNJLEtBQUEsRUFBQSxRQUNJLEVBQUEsT0FBQSxXQUNJLEVBQUEsTUFBQSxFQUFBLFdBRUosRUFBQSwwQkFNeEIsV0FDQyxHQUFBLEdBQUEsUUFBQSxPQUFBLHdCQUNBLEdBQUEsUUFBQSxxQkFBOEIsUUFBQSxTQUFBLEdBQzdCLEdBQUEsS0FRQSxPQVBBLEdBQUEsVUFBQSxTQUFBLEdBQ0MsTUFBQSxJQUNDLE9BQUEsUUFDQSxJQUFBLEVBQ0EsT0FBQSxLQUdGLEtBRUQsRUFBQSxRQUFBLHlCQUFrQyxRQUFBLFNBQUEsR0FDakMsR0FBQSxLQVFBLE9BUEEsR0FBQSxXQUFBLFNBQUEsR0FDQyxNQUFBLElBQ0MsT0FBQSxRQUNBLElBQUEsRUFDQSxPQUFBLEtBR0YsUUFJRixXQUNDLEdBQUEsR0FBQSxRQUFBLE9BQUEsc0JBQ0MsR0FBQSxPQUFBLGFBQXNCLFdBQ25CLE1BQUEsVUFBQSxHQUNDLEdBQUEsWUFBQSxPQUFBLENBQ0QsSUFBQSxHQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxLQUFBLEVBQUEsRUFBQSxJQUNDLEVBQUEsS0FBQSxFQUFBLEdBQUEsR0FBQSxjQUFBLEVBQUEsR0FBQSxNQUFBLEdBRUQsT0FBQSxHQUdFLE1BQUEsR0FBQSxHQUFBLGNBQUEsRUFBQSxNQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3RyYWlsZXJQYXJrZScsIFsnYXBwRmlsdGVyc01vZHVsZScsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCAgJ2FwcENvbnRyb2xsZXJNb2R1bGUnLCBcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAnYXBwRGlyZWN0aXZlTW9kdWxlJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAnYXBwRmFjdG9yaWVzTW9kdWxlJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0ICAnbmdSb3V0ZScsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCAgJ3VpLmJvb3RzdHJhcCddKTsgLy9tYWluIG1vZHVsZVxudmFyIHNlYXJjaElucHV0OyAvL3JlY29yZHMgYSB1c2VyIGlucHV0XG5cblxuYXBwLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcbiAgICAgICAgXHQud2hlbignLycsIFxuXHQgICAgICAgIFx0e1xuXHQgICAgICAgIFx0XHR0ZW1wbGF0ZVVybDogJy4uL3RlbXBsYXRlcy90cmFpbGVyLWxpc3RpbmdzLmh0bWwnLFxuICAgICAgICAgICAgXHRcdGNvbnRyb2xsZXI6ICdzZWFyY2hBdXRvY29tcENvbnRyb2xsZXInXHRcblx0ICAgICAgICBcdH0pXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywgXG4gICAgICAgICAgICBcdHtcbiAgICAgICAgICAgIFx0XHR0ZW1wbGF0ZVVybDogJy4uL3RlbXBsYXRlcy9sb2dpbi5odG1sJ1xuICAgICAgICAgICAgXHR9KTtcblx0fV0pO1xuXG5hcHAuY29uc3RhbnQoJ2FwaUtleXMnLCB7XG5cdHlvdXR1YmVBUEk6ICdBSXphU3lEWWhxSDFndXZseHhvY3V0dHJ3eEUya2t2WWVmdTBjcW8nLFxuXHRyb3R0ZW5Ub21hdG9lc0FQSTogJzRjd2p0aGpxMmh5eHo3YW1oNmpqNXA0cCdcbn0pO1xuKGZ1bmN0aW9uKCl7XG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcENvbnRyb2xsZXJNb2R1bGUnLCBbXSk7XG5cdGFwcC5jb250cm9sbGVyKCdzZWFyY2hDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHNjZScsICd5b3V0dWJlQXBpU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRzY2UsIHlvdXR1YmVBcGlTZXJ2aWNlKSB7Ly9jb250cm9sbGVyIGZvciB0aGUgc2VhcmNoIHF1ZXJ5XG5cdFx0JHNjb3BlLnN1Ym1pdFNlYXJjaCA9IGZ1bmN0aW9uKGdlbnJlLCBjYWxsZWRGcm9tKSB7Ly9hcGkgY2FsbCBmb3IgdGhlIHF1ZXJ5L2dlbnJlXG5cdFx0ICBcdHZhciBxdWVyeVRleHQgPSAkc2NvcGUuc2VhcmNoVGV4dCxcblx0XHQgIFx0ICBcdHNlYXJjaFVybDtcblx0XHRcdCAgaWYgKGdlbnJlID09IHVuZGVmaW5lZCkge1xuXHRcdFx0ICBcdHZhciBnZW5yZSA9ICRzY29wZS5zZWFyY2hUZXh0LFxuXHRcdFx0ICBcdFx0c2VhcmNoVXJsID0gJ2h0dHBzOi8vZ2RhdGEueW91dHViZS5jb20vZmVlZHMvYXBpL3ZpZGVvcz9xPScrcXVlcnlUZXh0LnNwbGl0KCcgJykuam9pbignKycpKycrb2ZmaWNpYWwrdHJhaWxlciZ2PTImbWF4LXJlc3VsdHM9MyZhbHQ9anNvbiZjYXRlZ29yeT1tb3ZpZXMmY2FsbGJhY2s9SlNPTl9DQUxMQkFDSyc7XG5cdFx0XHQgIH1cblx0XHRcdCAgZWxzZSBzZWFyY2hVcmwgPSAnaHR0cHM6Ly9nZGF0YS55b3V0dWJlLmNvbS9mZWVkcy9hcGkvdmlkZW9zP3E9JytnZW5yZS5zcGxpdCgnICcpLmpvaW4oJysnKSsnK29mZmljaWFsK3RyYWlsZXIrLWdhbWUmdj0yJm9yZGVyYnk9cmVsZXZhbmNlJm1heC1yZXN1bHRzPTIwJmhkPXRydWUmYWx0PWpzb24mY2F0ZWdvcnk9bW92aWVzJmNhbGxiYWNrPUpTT05fQ0FMTEJBQ0snO1xuXHRcdCAgeW91dHViZUFwaVNlcnZpY2UuZ2V0VmlkZW9zKHNlYXJjaFVybCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xuXHRcdFx0aWYoZGF0YS5mZWVkLmVudHJ5ICE9IHVuZGVmaW5lZCkgey8vY2hlY2tzIHRvIHNlZSBpZiB0aGVyZSBpcyBhIGZlZWRcblx0XHRcdFx0dmFyIHZpZGVvc1NyYyA9IFtdO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMCwgbCA9IGRhdGEuZmVlZC5lbnRyeS5sZW5ndGg7IGkgPCBsOyBpKyspIHsvL2NsZWFucyB1cCB0aGUgYXJyYXlcblx0XHRcdFx0XHR2aWRlb3NTcmMucHVzaCgkc2NlLnRydXN0QXNSZXNvdXJjZVVybChkYXRhLmZlZWQuZW50cnlbaV0ubGlua1swXS5ocmVmLnJlcGxhY2UoXCJ3YXRjaD92PVwiLCBcImVtYmVkL1wiKS5yZXBsYWNlKCcmZmVhdHVyZT15b3V0dWJlX2dkYXRhJywgJycpKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0JHNjb3BlLnByb2dyYW1zID0gdmlkZW9zU3JjO1xuXHRcdFx0XHQkc2NvcGUuc2VhcmNoVGV4dCA9ICcnO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7Ly9pZiBubyBmZWVkIHNob3cgZXJyb3IgbXNnXG5cdFx0XHRcdCRzY29wZS5wcm9ncmFtcyA9ICcnO1xuXHRcdFx0fVxuXHRcdFx0fSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcblx0XHRcdFx0Y29uc29sZS5sb2coJ2VycicpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XSk7Ly9zZWFyY2hDb250cm9sbGVyXG5cdGFwcC5jb250cm9sbGVyKCdnZW5yZUNvbnRyb2xsZXInLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7Ly9ob2xkcyB0aGUgZ2VucmVzIGFuZCB5b3V0dWJlIGFwaSByZWxhdGVkIGlkc1xuXHRcdCRzY29wZS5nZW5yZXMgPSBbXG5cdFx0XHR7bmFtZTogXCJob3Jyb3JcIiwgaWQ6IDEwfSwgXG5cdFx0XHR7bmFtZTogXCJzY2ktZmlcIiwgaWQ6IDEzfSwgXG5cdFx0XHR7bmFtZTogXCJkcmFtYVwiLCBpZDogNn0sIFxuXHRcdFx0e25hbWU6IFwiY29tZWR5XCIsIGlkOiA0fSwgXG5cdFx0XHR7bmFtZTogXCJ0aHJpbGxlclwifSwgXG5cdFx0XHR7bmFtZTogXCJkb2N1bWVudGFyeVwifSwgXG5cdFx0XHR7bmFtZTogXCJhbmltYXRpb25cIiwgaWQ6IDJ9LCBcblx0XHRcdHtuYW1lOiBcImFjdGlvblwiLCBpZDogMX0sIFxuXHRcdFx0e25hbWU6IFwicm9tYW5jZVwiLCBpZDogMTJ9LFxuXHRcdFx0e25hbWU6IFwiY3JpbWVcIiwgaWQ6IDV9LFxuXHRcdFx0e25hbWU6IFwiZmFtaWx5XCIsIGlkOiA4fSxcblx0XHRcdHtuYW1lOiBcInNwb3J0c1wiLCBpZDogMTV9LFxuXHRcdFx0e25hbWU6IFwiYWR2ZW50dXJlXCIsIGlkOiAxfSxcblx0XHRcdHtuYW1lOiBcImZhbnRhc3lcIn0sXG5cdFx0XHR7bmFtZTogXCJoaXN0b3J5XCJ9LFxuXHRcdFx0e25hbWU6IFwibXlzdGVyeVwiLCBpZDogMTF9LFxuXHRcdFx0e25hbWU6IFwibXVzaWNhbFwifSxcblx0XHRcdHtuYW1lOiBcIndlc3Rlcm5cIn1cblx0XHRdO1xuXHRcdCRzY29wZS5zZWxlY3Q9IGZ1bmN0aW9uKGdlbnJlKSB7XG4gICAgICAgXHRcdCRzY29wZS5zZWxlY3RlZCA9IGdlbnJlOyBcbiAgICBcdH07XG5cdCAgICAkc2NvcGUuZ2VucmVDbGFzcyA9IGZ1bmN0aW9uKGdlbnJlKSB7XG5cdCAgICAgICAgcmV0dXJuIGdlbnJlID09PSAkc2NvcGUuc2VsZWN0ZWQgPyAnYWN0aXZlJyA6IHVuZGVmaW5lZDtcblx0ICAgIH07XG5cdH1dKTsvL2dlbnJlQ29udHJvbGxlclxuXHRcblx0YXBwLmNvbnRyb2xsZXIoJ3NlYXJjaEF1dG9jb21wQ29udHJvbGxlcicsWyckc2NvcGUnLCAnJHNjZScsICdhcGlLZXlzJywgJ3JvdHRlblRvbWF0b2VzU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJHNjZSwgYXBpS2V5cywgcm90dGVuVG9tYXRvZXNTZXJ2aWNlKXtcblx0XHQkc2NvcGUuYXV0b2NvbXBsZXRlU2VhcmNoID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cdFx0XHRcdHZhciB1cmwgPSBcImh0dHA6Ly9hcGkucm90dGVudG9tYXRvZXMuY29tL2FwaS9wdWJsaWMvdjEuMC9tb3ZpZXMuanNvbj9hcGlrZXk9XCIgKyBhcGlLZXlzLnJvdHRlblRvbWF0b2VzQVBJICsgXCImcT1cIitpbnB1dC5zcGxpdCgnICcpLmpvaW4oJysnKStcIiZwYWdlX2xpbWl0PTUmY2FsbGJhY2s9SlNPTl9DQUxMQkFDS1wiLFxuXHRcdFx0XHQgXHRhdXRvU3VnZ2VzdCA9IFtdLFxuXHRcdFx0XHQgXHRyYXRpbmdzID0gW10sXG5cdFx0XHRcdFx0c3VnZ2VzdGlvbiA9ICcnO1xuXHRcdFx0aWYgKGlucHV0Lmxlbmd0aCA+IDUpIHtcblx0XHRcdFx0cm90dGVuVG9tYXRvZXNTZXJ2aWNlLmdldFJhdGluZ3ModXJsKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XG5cdFx0XHRcdFx0XHQkc2NvcGUuU2hvd0F1dG9TdWdnZXN0aW9ucyA9IHRydWU7XG5cdFx0XHRcdFx0XHR2YXIgcmF0aW5nLCB0aXRsZTtcblx0XHRcdFx0XHRcdGlmKGRhdGFbJ21vdmllcyddLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhWydtb3ZpZXMnXS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmF0aW5nID0gZGF0YVsnbW92aWVzJ11baV1bJ3JhdGluZ3MnXVsnY3JpdGljc19zY29yZSddO1xuXHRcdFx0XHRcdFx0XHRcdFx0dGl0bGUgPSBkYXRhWydtb3ZpZXMnXVtpXVsndGl0bGUnXTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aXRsZSAhPSAnJyAmJiB0aXRsZS5sZW5ndGggPCAzMylcblx0XHRcdFx0XHRcdFx0XHRcdFx0c3VnZ2VzdGlvbiA9IHRpdGxlO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAodGl0bGUubGVuZ3RoID4gMzYpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHN1Z2dlc3Rpb24gPSB0aXRsZS5zbGljZSgwLCAzNikgKyAnLi4uJztcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChyYXRpbmcgIT0gLTEgJiYgdGl0bGUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRhdXRvU3VnZ2VzdC5wdXNoKHt0aXRsZTogc3VnZ2VzdGlvbiwgcmF0aW5nOiByYXRpbmd9KTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHQkc2NvcGUuQXV0b1N1Z2dlc3Rpb25zID0gYXV0b1N1Z2dlc3Q7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdlcnInKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIFxuXHRcdFx0XHQkc2NvcGUuQXV0b1N1Z2dlc3Rpb25zID0gJyc7XG5cdFx0XHRcdCRzY29wZS5SYXRpbmdzID0gJyc7XG5cdFx0fVxuXHR9XSk7Ly9TZWFyY2hBdXRvY29tcENvbnRyb2xsZXJcbn0pKCk7XG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHBEaXJlY3RpdmVNb2R1bGUnLCBbXSk7XG4gICAgICAgIGFwcC5kaXJlY3RpdmUoJ25nRW50ZXInLCBmdW5jdGlvbiAoKSB7Ly9kaXJlY3RpdmUgZm9yIGVudGVyIGtleVxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoXCJrZXlkb3duIGtleXByZXNzXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZihldmVudC53aGljaCA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZXZhbChhdHRycy5uZ0VudGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwRmFjdG9yaWVzTW9kdWxlJywgW10pO1xuXHRhcHAuZmFjdG9yeSgneW91dHViZUFwaVNlcnZpY2UnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcblx0XHR2YXIgeW91dHViZUFQSSA9IHt9O1x0XG5cdFx0eW91dHViZUFQSS5nZXRWaWRlb3MgPSBmdW5jdGlvbihzZWFyY2hVcmwpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdG1ldGhvZDogJ0pTT05QJyxcblx0XHRcdFx0dXJsOiBzZWFyY2hVcmwsXG5cdFx0XHRcdGNhY2hlOiB0cnVlXG5cdFx0XHR9KTtcblx0XHR9Oy8vZ2V0VmlkZW9zXG5cdFx0cmV0dXJuIHlvdXR1YmVBUEk7XG5cdH1dKTtcblx0YXBwLmZhY3RvcnkoJ3JvdHRlblRvbWF0b2VzU2VydmljZScsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuXHRcdHZhciByb3R0ZW5Ub21hdG9lc0FQSSA9IHt9O1xuXHRcdHJvdHRlblRvbWF0b2VzQVBJLmdldFJhdGluZ3MgPSBmdW5jdGlvbih1cmwpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdG1ldGhvZDogJ0pTT05QJyxcblx0XHRcdFx0dXJsOiB1cmwsXG5cdFx0XHRcdGNhY2hlOiB0cnVlXG5cdFx0XHR9KTtcblx0XHR9O1xuXHRcdHJldHVybiByb3R0ZW5Ub21hdG9lc0FQSTtcblx0fV0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcEZpbHRlcnNNb2R1bGUnLCBbXSk7XG5cdFx0YXBwLmZpbHRlcignY2FwaXRhbGl6ZScsIGZ1bmN0aW9uKCkge1xuXHQgIFx0XHRyZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcblx0ICBcdFx0XHRpZihpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSBpbnB1dC5sZW5ndGgsIG8gPSBbXTsgaSA8IGw7IGkrKykge1xuXHRcdFx0XHRcdFx0by5wdXNoKGlucHV0W2ldWzBdLnRvVXBwZXJDYXNlKCkgKyBpbnB1dFtpXS5zbGljZSgxKSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fVxuXHQgIFx0XHRcdGVsc2Vcblx0ICBcdFx0XHRcdHJldHVybiBpbnB1dFswXS50b1VwcGVyQ2FzZSgpICsgaW5wdXQuc2xpY2UoMSk7XG5cdCAgXHR9ICBcblx0fSk7XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==