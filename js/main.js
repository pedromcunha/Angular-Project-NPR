var app=angular.module("trailerParke",["appFiltersModule","appControllerModule","appDirectiveModule","appFactoriesModule"]),searchInput;app.constant("apiKeys",{youtubeAPI:"AIzaSyDYhqH1guvlxxocuttrwxE2kkvYefu0cqo",rottenTomatoesAPI:"4cwjthjq2hyxz7amh6jj5p4p"}),function(){var e=angular.module("appControllerModule",[]);e.controller("searchController",["$scope","$sce","youtubeApiService",function(e,t,o){e.submitSearch=function(r){var n,a=e.searchText;if(void 0==r)var r=e.searchText,n="https://gdata.youtube.com/feeds/api/videos?q="+a.split(" ").join("+")+"+official+trailer&v=2&max-results=3&alt=json&category=movies&callback=JSON_CALLBACK";else n="https://gdata.youtube.com/feeds/api/videos?q="+r.split(" ").join("+")+"+official+trailer+-game&v=2&orderby=relevance&max-results=20&hd=true&alt=json&category=movies&callback=JSON_CALLBACK";o.getVideos(n).success(function(o){if(void 0!=o.feed.entry){for(var r=[],n=0,a=o.feed.entry.length;a>n;n++)r.push(t.trustAsResourceUrl(o.feed.entry[n].link[0].href.replace("watch?v=","embed/").replace("&feature=youtube_gdata","")));e.programs=r,e.searchText=""}else e.programs=""}).error(function(){console.log("err")})}}]),e.controller("genreController",["$scope",function(e){e.genres=[{name:"horror",id:10},{name:"sci-fi",id:13},{name:"drama",id:6},{name:"comedy",id:4},{name:"thriller"},{name:"documentary"},{name:"animation",id:2},{name:"action",id:1},{name:"romance",id:12},{name:"crime",id:5},{name:"family",id:8},{name:"sports",id:15},{name:"adventure",id:1},{name:"fantasy"},{name:"history"},{name:"mystery",id:11},{name:"musical"},{name:"western"}],e.select=function(t){e.selected=t},e.genreClass=function(t){return t===e.selected?"active":void 0}}]),e.controller("searchAutocompController",["$scope","$sce","apiKeys","rottenTomatoesService",function(e,t,o,r){e.autocompleteSearch=function(t){var n="http://api.rottentomatoes.com/api/public/v1.0/movies.json?apikey="+o.rottenTomatoesAPI+"&q="+t.split(" ").join("+")+"&page_limit=5&callback=JSON_CALLBACK",a=[],i="";t.length>5?r.getRatings(n).success(function(t){e.ShowAutoSuggestions=!0;var o,r;if(t.movies.length>0){for(var n=0;n<t.movies.length;n++)o=t.movies[n].ratings.critics_score,r=t.movies[n].title,""!=r&&r.length<33?i=r:r.length>36&&(i=r.slice(0,36)+"..."),-1!=o&&r.length>0&&a.push({title:i,rating:o});e.AutoSuggestions=a}}).error(function(){console.log("err")}):e.AutoSuggestions="",e.Ratings=""}}])}(),function(){var e=angular.module("appDirectiveModule",[]);e.directive("ngEnter",function(){return function(e,t,o){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(o.ngEnter)}),t.preventDefault())})}})}(),function(){var e=angular.module("appFactoriesModule",[]);e.factory("youtubeApiService",["$http",function(e){var t={};return t.getVideos=function(t){return e({method:"JSONP",url:t,cache:!0})},t}]),e.factory("rottenTomatoesService",["$http",function(e){var t={};return t.getRatings=function(t){return e({method:"JSONP",url:t,cache:!0})},t}])}(),function(){var e=angular.module("appFiltersModule",[]);e.filter("capitalize",function(){return function(e){if(e instanceof Array){for(var t=0,o=e.length,r=[];o>t;t++)r.push(e[t][0].toUpperCase()+e[t].slice(1));return r}return e[0].toUpperCase()+e.slice(1)}})}();
//# sourceMappingURL=data:application/json;base64,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LEVBQUEsUUFDSSxFQUFBLE9BQUEsV0FDSSxFQUFBLE1BQUEsRUFBQSxXQUVKLEVBQUEsMEJBTXhCLFdBQ0MsR0FBQSxHQUFBLFFBQUEsT0FBQSx3QkFDQSxHQUFBLFFBQUEscUJBQThCLFFBQUEsU0FBQSxHQUM3QixHQUFBLEtBUUEsT0FQQSxHQUFBLFVBQUEsU0FBQSxHQUNDLE1BQUEsSUFDQyxPQUFBLFFBQ0EsSUFBQSxFQUNBLE9BQUEsS0FHRixLQUVELEVBQUEsUUFBQSx5QkFBa0MsUUFBQSxTQUFBLEdBQ2pDLEdBQUEsS0FRQSxPQVBBLEdBQUEsV0FBQSxTQUFBLEdBQ0MsTUFBQSxJQUNDLE9BQUEsUUFDQSxJQUFBLEVBQ0EsT0FBQSxLQUdGLFFBSUYsV0FDQyxHQUFBLEdBQUEsUUFBQSxPQUFBLHNCQUNDLEdBQUEsT0FBQSxhQUFzQixXQUNuQixNQUFBLFVBQUEsR0FDQyxHQUFBLFlBQUEsT0FBQSxDQUNELElBQUEsR0FBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsS0FBQSxFQUFBLEVBQUEsSUFDQyxFQUFBLEtBQUEsRUFBQSxHQUFBLEdBQUEsY0FBQSxFQUFBLEdBQUEsTUFBQSxHQUVELE9BQUEsR0FHRSxNQUFBLEdBQUEsR0FBQSxjQUFBLEVBQUEsTUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCd0cmFpbGVyUGFya2UnLCBbJ2FwcEZpbHRlcnNNb2R1bGUnLCAnYXBwQ29udHJvbGxlck1vZHVsZScsICdhcHBEaXJlY3RpdmVNb2R1bGUnLCAnYXBwRmFjdG9yaWVzTW9kdWxlJ10pOyAvL21haW4gbW9kdWxlXG52YXIgc2VhcmNoSW5wdXQ7IC8vcmVjb3JkcyBhIHVzZXIgaW5wdXRcblxuYXBwLmNvbnN0YW50KCdhcGlLZXlzJywge1xuXHR5b3V0dWJlQVBJOiAnQUl6YVN5RFlocUgxZ3V2bHh4b2N1dHRyd3hFMmtrdlllZnUwY3FvJyxcblx0cm90dGVuVG9tYXRvZXNBUEk6ICc0Y3dqdGhqcTJoeXh6N2FtaDZqajVwNHAnXG59KTtcbihmdW5jdGlvbigpe1xudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHBDb250cm9sbGVyTW9kdWxlJywgW10pO1xuXHRhcHAuY29udHJvbGxlcignc2VhcmNoQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRzY2UnLCAneW91dHViZUFwaVNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc2NlLCB5b3V0dWJlQXBpU2VydmljZSkgey8vY29udHJvbGxlciBmb3IgdGhlIHNlYXJjaCBxdWVyeVxuXHRcdCRzY29wZS5zdWJtaXRTZWFyY2ggPSBmdW5jdGlvbihnZW5yZSwgY2FsbGVkRnJvbSkgey8vYXBpIGNhbGwgZm9yIHRoZSBxdWVyeS9nZW5yZVxuXHRcdCAgXHR2YXIgcXVlcnlUZXh0ID0gJHNjb3BlLnNlYXJjaFRleHQsXG5cdFx0ICBcdCAgXHRzZWFyY2hVcmw7XG5cdFx0XHQgIGlmIChnZW5yZSA9PSB1bmRlZmluZWQpIHtcblx0XHRcdCAgXHR2YXIgZ2VucmUgPSAkc2NvcGUuc2VhcmNoVGV4dCxcblx0XHRcdCAgXHRcdHNlYXJjaFVybCA9ICdodHRwczovL2dkYXRhLnlvdXR1YmUuY29tL2ZlZWRzL2FwaS92aWRlb3M/cT0nK3F1ZXJ5VGV4dC5zcGxpdCgnICcpLmpvaW4oJysnKSsnK29mZmljaWFsK3RyYWlsZXImdj0yJm1heC1yZXN1bHRzPTMmYWx0PWpzb24mY2F0ZWdvcnk9bW92aWVzJmNhbGxiYWNrPUpTT05fQ0FMTEJBQ0snO1xuXHRcdFx0ICB9XG5cdFx0XHQgIGVsc2Ugc2VhcmNoVXJsID0gJ2h0dHBzOi8vZ2RhdGEueW91dHViZS5jb20vZmVlZHMvYXBpL3ZpZGVvcz9xPScrZ2VucmUuc3BsaXQoJyAnKS5qb2luKCcrJykrJytvZmZpY2lhbCt0cmFpbGVyKy1nYW1lJnY9MiZvcmRlcmJ5PXJlbGV2YW5jZSZtYXgtcmVzdWx0cz0yMCZoZD10cnVlJmFsdD1qc29uJmNhdGVnb3J5PW1vdmllcyZjYWxsYmFjaz1KU09OX0NBTExCQUNLJztcblx0XHQgIHlvdXR1YmVBcGlTZXJ2aWNlLmdldFZpZGVvcyhzZWFyY2hVcmwpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcblx0XHRcdGlmKGRhdGEuZmVlZC5lbnRyeSAhPSB1bmRlZmluZWQpIHsvL2NoZWNrcyB0byBzZWUgaWYgdGhlcmUgaXMgYSBmZWVkXG5cdFx0XHRcdHZhciB2aWRlb3NTcmMgPSBbXTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSBkYXRhLmZlZWQuZW50cnkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7Ly9jbGVhbnMgdXAgdGhlIGFycmF5XG5cdFx0XHRcdFx0dmlkZW9zU3JjLnB1c2goJHNjZS50cnVzdEFzUmVzb3VyY2VVcmwoZGF0YS5mZWVkLmVudHJ5W2ldLmxpbmtbMF0uaHJlZi5yZXBsYWNlKFwid2F0Y2g/dj1cIiwgXCJlbWJlZC9cIikucmVwbGFjZSgnJmZlYXR1cmU9eW91dHViZV9nZGF0YScsICcnKSkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCRzY29wZS5wcm9ncmFtcyA9IHZpZGVvc1NyYztcblx0XHRcdFx0JHNjb3BlLnNlYXJjaFRleHQgPSAnJztcblx0XHRcdH1cblx0XHRcdGVsc2Ugey8vaWYgbm8gZmVlZCBzaG93IGVycm9yIG1zZ1xuXHRcdFx0XHQkc2NvcGUucHJvZ3JhbXMgPSAnJztcblx0XHRcdH1cblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdlcnInKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fV0pOy8vc2VhcmNoQ29udHJvbGxlclxuXHRhcHAuY29udHJvbGxlcignZ2VucmVDb250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbigkc2NvcGUpey8vaG9sZHMgdGhlIGdlbnJlcyBhbmQgeW91dHViZSBhcGkgcmVsYXRlZCBpZHNcblx0XHQkc2NvcGUuZ2VucmVzID0gW1xuXHRcdFx0e25hbWU6IFwiaG9ycm9yXCIsIGlkOiAxMH0sIFxuXHRcdFx0e25hbWU6IFwic2NpLWZpXCIsIGlkOiAxM30sIFxuXHRcdFx0e25hbWU6IFwiZHJhbWFcIiwgaWQ6IDZ9LCBcblx0XHRcdHtuYW1lOiBcImNvbWVkeVwiLCBpZDogNH0sIFxuXHRcdFx0e25hbWU6IFwidGhyaWxsZXJcIn0sIFxuXHRcdFx0e25hbWU6IFwiZG9jdW1lbnRhcnlcIn0sIFxuXHRcdFx0e25hbWU6IFwiYW5pbWF0aW9uXCIsIGlkOiAyfSwgXG5cdFx0XHR7bmFtZTogXCJhY3Rpb25cIiwgaWQ6IDF9LCBcblx0XHRcdHtuYW1lOiBcInJvbWFuY2VcIiwgaWQ6IDEyfSxcblx0XHRcdHtuYW1lOiBcImNyaW1lXCIsIGlkOiA1fSxcblx0XHRcdHtuYW1lOiBcImZhbWlseVwiLCBpZDogOH0sXG5cdFx0XHR7bmFtZTogXCJzcG9ydHNcIiwgaWQ6IDE1fSxcblx0XHRcdHtuYW1lOiBcImFkdmVudHVyZVwiLCBpZDogMX0sXG5cdFx0XHR7bmFtZTogXCJmYW50YXN5XCJ9LFxuXHRcdFx0e25hbWU6IFwiaGlzdG9yeVwifSxcblx0XHRcdHtuYW1lOiBcIm15c3RlcnlcIiwgaWQ6IDExfSxcblx0XHRcdHtuYW1lOiBcIm11c2ljYWxcIn0sXG5cdFx0XHR7bmFtZTogXCJ3ZXN0ZXJuXCJ9XG5cdFx0XTtcblx0XHQkc2NvcGUuc2VsZWN0PSBmdW5jdGlvbihnZW5yZSkge1xuICAgICAgIFx0XHQkc2NvcGUuc2VsZWN0ZWQgPSBnZW5yZTsgXG4gICAgXHR9O1xuXHQgICAgJHNjb3BlLmdlbnJlQ2xhc3MgPSBmdW5jdGlvbihnZW5yZSkge1xuXHQgICAgICAgIHJldHVybiBnZW5yZSA9PT0gJHNjb3BlLnNlbGVjdGVkID8gJ2FjdGl2ZScgOiB1bmRlZmluZWQ7XG5cdCAgICB9O1xuXHR9XSk7Ly9nZW5yZUNvbnRyb2xsZXJcblx0YXBwLmNvbnRyb2xsZXIoJ3NlYXJjaEF1dG9jb21wQ29udHJvbGxlcicsWyckc2NvcGUnLCAnJHNjZScsICdhcGlLZXlzJywgJ3JvdHRlblRvbWF0b2VzU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJHNjZSwgYXBpS2V5cywgcm90dGVuVG9tYXRvZXNTZXJ2aWNlKXtcblx0XHQkc2NvcGUuYXV0b2NvbXBsZXRlU2VhcmNoID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cdFx0XHRcdHZhciB1cmwgPSBcImh0dHA6Ly9hcGkucm90dGVudG9tYXRvZXMuY29tL2FwaS9wdWJsaWMvdjEuMC9tb3ZpZXMuanNvbj9hcGlrZXk9XCIgKyBhcGlLZXlzLnJvdHRlblRvbWF0b2VzQVBJICsgXCImcT1cIitpbnB1dC5zcGxpdCgnICcpLmpvaW4oJysnKStcIiZwYWdlX2xpbWl0PTUmY2FsbGJhY2s9SlNPTl9DQUxMQkFDS1wiLFxuXHRcdFx0XHQgXHRhdXRvU3VnZ2VzdCA9IFtdLFxuXHRcdFx0XHQgXHRyYXRpbmdzID0gW10sXG5cdFx0XHRcdFx0c3VnZ2VzdGlvbiA9ICcnO1xuXHRcdFx0aWYgKGlucHV0Lmxlbmd0aCA+IDUpIHtcblx0XHRcdFx0cm90dGVuVG9tYXRvZXNTZXJ2aWNlLmdldFJhdGluZ3ModXJsKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XG5cdFx0XHRcdFx0XHQkc2NvcGUuU2hvd0F1dG9TdWdnZXN0aW9ucyA9IHRydWU7XG5cdFx0XHRcdFx0XHR2YXIgcmF0aW5nLCB0aXRsZTtcblx0XHRcdFx0XHRcdGlmKGRhdGFbJ21vdmllcyddLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhWydtb3ZpZXMnXS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmF0aW5nID0gZGF0YVsnbW92aWVzJ11baV1bJ3JhdGluZ3MnXVsnY3JpdGljc19zY29yZSddO1xuXHRcdFx0XHRcdFx0XHRcdFx0dGl0bGUgPSBkYXRhWydtb3ZpZXMnXVtpXVsndGl0bGUnXTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aXRsZSAhPSAnJyAmJiB0aXRsZS5sZW5ndGggPCAzMylcblx0XHRcdFx0XHRcdFx0XHRcdFx0c3VnZ2VzdGlvbiA9IHRpdGxlO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAodGl0bGUubGVuZ3RoID4gMzYpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHN1Z2dlc3Rpb24gPSB0aXRsZS5zbGljZSgwLCAzNikgKyAnLi4uJztcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChyYXRpbmcgIT0gLTEgJiYgdGl0bGUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRhdXRvU3VnZ2VzdC5wdXNoKHt0aXRsZTogc3VnZ2VzdGlvbiwgcmF0aW5nOiByYXRpbmd9KTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHQkc2NvcGUuQXV0b1N1Z2dlc3Rpb25zID0gYXV0b1N1Z2dlc3Q7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzKXtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdlcnInKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIFxuXHRcdFx0XHQkc2NvcGUuQXV0b1N1Z2dlc3Rpb25zID0gJyc7XG5cdFx0XHRcdCRzY29wZS5SYXRpbmdzID0gJyc7XG5cdFx0fVxuXHR9XSk7Ly9TZWFyY2hBdXRvY29tcENvbnRyb2xsZXJcbn0pKCk7XG4oZnVuY3Rpb24oKSB7XG4gICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHBEaXJlY3RpdmVNb2R1bGUnLCBbXSk7XG4gICAgICAgIGFwcC5kaXJlY3RpdmUoJ25nRW50ZXInLCBmdW5jdGlvbiAoKSB7Ly9kaXJlY3RpdmUgZm9yIGVudGVyIGtleVxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoXCJrZXlkb3duIGtleXByZXNzXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZihldmVudC53aGljaCA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZXZhbChhdHRycy5uZ0VudGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG59KSgpO1xuKGZ1bmN0aW9uKCl7XG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwRmFjdG9yaWVzTW9kdWxlJywgW10pO1xuXHRhcHAuZmFjdG9yeSgneW91dHViZUFwaVNlcnZpY2UnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcblx0XHR2YXIgeW91dHViZUFQSSA9IHt9O1x0XG5cdFx0eW91dHViZUFQSS5nZXRWaWRlb3MgPSBmdW5jdGlvbihzZWFyY2hVcmwpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdG1ldGhvZDogJ0pTT05QJyxcblx0XHRcdFx0dXJsOiBzZWFyY2hVcmwsXG5cdFx0XHRcdGNhY2hlOiB0cnVlXG5cdFx0XHR9KTtcblx0XHR9Oy8vZ2V0VmlkZW9zXG5cdFx0cmV0dXJuIHlvdXR1YmVBUEk7XG5cdH1dKTtcblx0YXBwLmZhY3RvcnkoJ3JvdHRlblRvbWF0b2VzU2VydmljZScsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCkge1xuXHRcdHZhciByb3R0ZW5Ub21hdG9lc0FQSSA9IHt9O1xuXHRcdHJvdHRlblRvbWF0b2VzQVBJLmdldFJhdGluZ3MgPSBmdW5jdGlvbih1cmwpIHtcblx0XHRcdHJldHVybiAkaHR0cCh7XG5cdFx0XHRcdG1ldGhvZDogJ0pTT05QJyxcblx0XHRcdFx0dXJsOiB1cmwsXG5cdFx0XHRcdGNhY2hlOiB0cnVlXG5cdFx0XHR9KTtcblx0XHR9O1xuXHRcdHJldHVybiByb3R0ZW5Ub21hdG9lc0FQSTtcblx0fV0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcEZpbHRlcnNNb2R1bGUnLCBbXSk7XG5cdFx0YXBwLmZpbHRlcignY2FwaXRhbGl6ZScsIGZ1bmN0aW9uKCkge1xuXHQgIFx0XHRyZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcblx0ICBcdFx0XHRpZihpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSB7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGwgPSBpbnB1dC5sZW5ndGgsIG8gPSBbXTsgaSA8IGw7IGkrKykge1xuXHRcdFx0XHRcdFx0by5wdXNoKGlucHV0W2ldWzBdLnRvVXBwZXJDYXNlKCkgKyBpbnB1dFtpXS5zbGljZSgxKSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fVxuXHQgIFx0XHRcdGVsc2Vcblx0ICBcdFx0XHRcdHJldHVybiBpbnB1dFswXS50b1VwcGVyQ2FzZSgpICsgaW5wdXQuc2xpY2UoMSk7XG5cdCAgXHR9ICBcblx0fSk7XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==